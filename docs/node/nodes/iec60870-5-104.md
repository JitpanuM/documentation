---
hide_table_of_contents: true
---

# IEC60870-5-104

The `iec60870-5-104` node-type creates a TCP server to provide data to a single IEC60870-5-104 "Master".

:::note Note
The data is sent periodically and buffered until a a client connects.
The internal buffer is of fixed size and will drop the oldest messages on overflow. (See `high_priority_queue` and `low_priority_queue` configuration)
:::

## Prerequisites

This node-type requires [lib60870](https://www.mz-automation.de/communication-protocols/iec-60870-5-101-104-c-source-code-library/) (>= 2.3.1).

## Configuration {#config}

import ApiSchema from '@theme/ApiSchema';

<ApiSchema id="node" example pointer="#/components/schemas/iec60870-5-104" />

## Example

``` title="node/etc/examples/nodes/iec60870.conf"
nodes = {
		iec104 = {
		type = "iec60870-5-104"

		# network address and port of the server
		# 0.0.0.0 listens on all interfaces
		address = "0.0.0.0"
		port = 2404
		# common address of this IEC104 slave
		ca = 41025
		# queue size for the periodic messages
		low_priority_queue = 100
		# queue size for interrogation responses
		high_priority_queue = 100

		out = {
			# map signals to information object addresses and asdu data types
			# one asdu per specified asdu_type_id/asdu_type+with_timestamp is
			# send for each sample. Signals of the same type are collected
			# in a single asdu
			signals = (
				{
					# the asdu data type
					asdu_type = "normalized-float"
					# add 56 bit unix timestamp to asdu
					with_timestamp = false
					# the information object address of this signal
					ioa = 4202832
				},
				{
					# equivalent to the asdu_type above
					asdu_type_id = "M_ME_NA_1"
					ioa = 4202852
				},
				{
					# a boolean value
					asdu_type = "single-point"
					with_timestamp = true
					ioa = 4206948
				}
			)
		}
	}
}
```